[env:freenove_esp32_s3_wroom]
platform = espressif32
board = freenove_esp32_s3_wroom
framework = arduino

; ============================================================================
; CONFIGURAÇÕES DE HARDWARE
; ============================================================================
board_build.mcu = esp32s3
board_build.f_cpu = 240000000L
board_build.f_flash = 80000000L
board_build.flash_mode = qio
board_build.flash_size = 8MB

; PSRAM (importante para LVGL)
board_build.arduino.memory_type = qio_opi

; Partições customizadas (8MB flash)
board_build.partitions = partitions_8MB.csv

; ============================================================================
; UPLOAD E MONITOR
; ============================================================================
upload_speed = 921600
monitor_speed = 115200
monitor_filters = 
    esp32_exception_decoder
    time

; ============================================================================
; BUILD FLAGS - OTIMIZADO PARA DISPLAY
; ============================================================================
build_flags = 
    ; ESP32S3 específico
    -DARDUINO_ESP32S3_DEV
    -DBOARD_HAS_PSRAM
    
    ; UART NATIVO - NÃO USB CDC (previne bootloop!)
    -DARDUINO_USB_CDC_ON_BOOT=0
    -DARDUINO_USB_MODE=0
    
    ; Debug via Serial UART
    -DCORE_DEBUG_LEVEL=3
    -DCONFIG_ARDUHAL_LOG_DEFAULT_LEVEL_INFO
    
    ; LVGL Configurações
    -DLV_CONF_INCLUDE_SIMPLE
    -DLV_LVGL_H_INCLUDE_SIMPLE
    -I include
    
    ; Otimizações de performance
    -O2
    
    ; Watchdog - Configuração otimizada
    -DCONFIG_ESP_TASK_WDT_TIMEOUT_S=10
    -DCONFIG_ESP_INT_WDT_TIMEOUT_MS=800
    -DCONFIG_ESP_TASK_WDT_PANIC=0
    -DCONFIG_ESP_TASK_WDT_CHECK_IDLE_TASK_CPU0=0
    -DCONFIG_ESP_TASK_WDT_CHECK_IDLE_TASK_CPU1=0

; ============================================================================
; BIBLIOTECAS - SISTEMA COMPLETO
; ============================================================================
lib_deps = 
    ; LVGL (versão 8.x)
    lvgl/lvgl@^8.3.11
    
    ; LovyanGFX - Melhor suporte ESP32-S3 + Display
    lovyan03/LovyanGFX@^1.1.16
    
    ; Touchscreen XPT2046
    paulstoffregen/XPT2046_Touchscreen@0.0.0-alpha+sha.26b691b2c8
    
    ; Sensor Biométrico AS608
    adafruit/Adafruit Fingerprint Sensor Library@^2.1.3
    
    ; Leitor NFC/RFID PN532
    adafruit/Adafruit PN532@^1.3.1
    
    ; JSON para configurações
    bblanchon/ArduinoJson@^6.21.3
    
    ; Cliente SMTP para envio de e-mails
    mobizt/ESP Mail Client@^3.4.18

; ============================================================================
; DEBUGGING
; ============================================================================
debug_tool = esp-prog
debug_init_break = tbreak setup

; ============================================================================
; ADVANCED
; ============================================================================
build_unflags = 
    -std=gnu++11

build_type = release